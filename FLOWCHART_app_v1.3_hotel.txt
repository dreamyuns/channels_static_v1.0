================================================================================
숙소별 예약 통계 시스템 (app_v1.3_hotel.py) - 플로우차트
================================================================================

                    [시작]
                      |
                      v
            +-------------------+
            | 페이지 설정 초기화 |
            | (st.set_page_config) |
            +-------------------+
                      |
                      v
            +-------------------+
            | 로깅 모듈 초기화   |
            | (setup_logging)    |
            +-------------------+
                      |
                      v
            +-------------------+
            | 인증 모듈 Import  |
            +-------------------+
                      |
                      v
            +-------------------+
            | 쿠키에서 인증 정보 |
            | 복원 시도         |
            | (restore_auth_from_cookie) |
            +-------------------+
                      |
                      v
            +-------------------+
            | 복원 성공?        |
            +-------------------+
              |              |
            YES            NO
              |              |
              v              v
    +----------------+  +-------------------+
    | 인증 상태 확인  |  | JavaScript로 쿠키 |
    | (is_authenticated) | 읽기 시도        |
    +----------------+  +-------------------+
              |              |
              v              v
    +-------------------+
    | 인증됨?           |
    +-------------------+
      |              |
     YES            NO
      |              |
      v              v
+-----------+  +-------------------+
| 메인 앱   |  | 로그인 페이지 표시 |
+-----------+  +-------------------+
      |              |
      |              v
      |      +-------------------+
      |      | 로그인 폼 표시     |
      |      +-------------------+
      |              |
      |              v
      |      +-------------------+
      |      | 로그인 버튼 클릭? |
      |      +-------------------+
      |              |
      |            YES
      |              |
      |              v
      |      +-------------------+
      |      | authenticate_user |
      |      +-------------------+
      |              |
      |              v
      |      +-------------------+
      |      | 인증 성공?         |
      |      +-------------------+
      |        |              |
      |      YES            NO
      |        |              |
      |        v              v
      |  +-----------+  +-------------------+
      |  | 쿠키 저장  |  | 에러 메시지 표시  |
      |  | (JavaScript) |  | st.stop()       |
      |  +-----------+  +-------------------+
      |        |
      |        v
      |  +-------------------+
      |  | st.rerun()        |
      |  +-------------------+
      |        |
      +--------+
              |
              v
    +-------------------+
    | 헤더 표시         |
    | (제목 + 로그아웃) |
    +-------------------+
              |
              v
    +-------------------+
    | 로그아웃 버튼 클릭?|
    +-------------------+
      |              |
     YES            NO
      |              |
      v              v
+-----------+  +-------------------+
| 세션 삭제 |  | 사이드바 표시     |
| 쿠키 삭제 |  | (검색 조건)       |
| st.rerun()|  +-------------------+
+-----------+          |
                        v
            +-------------------+
            | 날짜유형 선택     |
            | (구매일/이용일)   |
            +-------------------+
                        |
                        v
            +-------------------+
            | 날짜 범위 선택     |
            | (시작일/종료일)   |
            +-------------------+
                        |
                        v
            +-------------------+
            | 날짜 검증         |
            | (범위, 최대 90일) |
            +-------------------+
                        |
                        v
            +-------------------+
            | 숙소 검색         |
            | (텍스트 입력)     |
            +-------------------+
                        |
                        v
            +-------------------+
            | 검색어 변경?      |
            | (엔터키 입력)     |
            +-------------------+
              |              |
             YES            NO
              |              |
              v              v
    +----------------+  +-------------------+
    | search_hotels  |  | 이전 결과 유지     |
    | (검색 실행)     |  +-------------------+
    +----------------+          |
              |                 |
              v                 |
    +-------------------+       |
    | 검색 결과 표시     |       |
    | (multiselect)     |       |
    +-------------------+       |
              |                 |
              +-----------------+
                        |
                        v
            +-------------------+
            | 숙소 선택/해제     |
            | (최대 10개)       |
            +-------------------+
                        |
                        v
            +-------------------+
            | 선택된 숙소 목록  |
            | (체크박스)        |
            +-------------------+
                        |
                        v
            +-------------------+
            | 체크 해제?        |
            +-------------------+
              |              |
             YES            NO
              |              |
              v              v
    +----------------+  +-------------------+
    | 숙소 삭제      |  | 조회/초기화 버튼  |
    | st.rerun()     |  +-------------------+
    +----------------+          |
                        |       |
                        +-------+
                        |
                        v
            +-------------------+
            | 조회 버튼 클릭?   |
            +-------------------+
              |              |
             YES            NO
              |              |
              v              v
    +----------------+  +-------------------+
    | 숙소 선택 확인  |  | 이전 결과 표시?   |
    +----------------+  +-------------------+
      |              |
    OK            없음
      |              |
      v              v
+-----------+  +-------------------+
| 데이터 조회 |  | 초기 화면 표시   |
| (fetch_hotel_data) | (사용 안내)  |
+-----------+  +-------------------+
      |
      v
+-------------------+
| 요약 통계 조회    |
| (fetch_hotel_summary_stats) |
+-------------------+
      |
      v
+-------------------+
| 결과 세션 저장    |
+-------------------+
      |
      v
+-------------------+
| 요약 통계 표시    |
| (2행 4컬럼)      |
+-------------------+
      |
      v
+-------------------+
| 상세 데이터 표시  |
| (상위 10개)      |
+-------------------+
      |
      v
+-------------------+
| 엑셀 다운로드     |
| (create_hotel_excel_download) |
+-------------------+
      |
      v
            [종료]

================================================================================
주요 분기점:
================================================================================

1. 인증 체크
   - 쿠키 복원 성공 → 인증 확인 → 메인 앱
   - 쿠키 복원 실패 → JavaScript 시도 → 로그인 페이지

2. 로그인 처리
   - 인증 성공 → 쿠키 저장 → st.rerun() → 메인 앱
   - 인증 실패 → 에러 메시지 → st.stop()

3. 숙소 검색
   - 검색어 변경 → 검색 실행 → 결과 표시
   - 검색어 미변경 → 이전 결과 유지

4. 조회 처리
   - 조회 버튼 클릭 → 데이터 조회 → 결과 표시
   - 조회 버튼 미클릭 → 이전 결과 표시 또는 초기 화면

================================================================================

